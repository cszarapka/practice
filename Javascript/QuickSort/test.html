<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Javascript QuickSort Test</title>
  <link rel="stylesheet" href="qunit/qunit-1.9.0.css">
</head>
<body>
  <div id="qunit"><!-- Unit Test Results --></div>
  <hr/>
  <h2>Benchmark</h2>
  <pre id="benchmark"><!-- Benchmark Results --></pre>

  <script src="qunit/qunit-1.9.0.js"></script>
  <script type="text/javascript" src="benchmark/benchmark.js" charset="utf-8"></script>
  <script src="Array.quicksort.js"></script>
  
  <script type="text/javascript">
    // Generate a random array
    function generateRandomArray(length, range) {
      var random = [];
      for(var i = 0; i < length; i++) {
        random[i] = Math.floor(Math.random() * range);
      }

      return random;
    }

    // Default sort() function sorts by alphabetical order
    function sortNumber(a,b) { 
      return a - b; 
    }

    /**
     * Unit Tests
     * -------------------------------------------------- */
    test( "Property: Array.swap defined", function() {
      ok('swap' in Array.prototype, "Pass" );
    });

    test( "Property: Array.quicksort defined", function() {
      ok('quicksort' in Array.prototype, "Pass" );
    });

    var LENGTH = 100;
    var RANGE = 10000;

    // QuickSort test
    for(var n = 0; n < 3; n++) {
      test( "Quicksort on random array", function() {
        random = generateRandomArray(LENGTH, RANGE);
        copy = random.slice(0); // deep copy
  
        deepEqual(copy.quicksort(), random.sort(sortNumber), "All elements should be the same");
      });
    }

    // QuickSort(Algorithm2) test
    for(var n = 0; n < 3; n++) {
      test( "Quicksort(Algorithm2) on random array", function() {
        random = generateRandomArray(LENGTH, RANGE);
        copy = random.slice(0);

        deepEqual(copy.quicksort2(), random.sort(sortNumber), "All elements should be the same");
      });
    }


    /**
     * Benchmarks
     * -------------------------------------------------- */
    Benchmark.STDOUT = document.getElementById('benchmark');
    
    var randoms = [];
    var copies = [];
    var copies2 = [];
    var COUNT = 10000;
    for(var i = 0; i < COUNT; i++) {
      random = generateRandomArray(LENGTH, RANGE);
      randoms.push(random);
      copies.push(random.slice(0));
      copies2.push(random.slice(0));
    }

    Benchmark.benchmark({
      NativeSort : function() {
        for(var i = 0; i < COUNT; i++) {
          randoms[i].sort(sortNumber);
        }
      },
      QuickSort : function() {
        for(var i = 0; i < COUNT; i++) {
          copies[i].quicksort();
        }
      },
      QuickSort2 : function() {
        for(var i = 0; i < COUNT; i++) {
          copies2[i].quicksort2();
        }
      }
    });
  </script>
</body>
</html>